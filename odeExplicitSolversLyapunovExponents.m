function [t, zsol, lyap_exp, dzdt_eval] = odeExplicitSolversLyapunovExponents(odefun, tspan, tau, incond, options)
%odeExplicitSolversLyapunovExponents Solve augmented ODE systems for Lyapunov Exponents using fixed-step explicit RK methods.
%   [t, z, lyap_exp] = odeExplicitSolversLyapunovExponents(odefun, tspan, tau, z0) 
%   integrates the augmented system of differential equations (typically 
%   the state equations coupled with the variational equations) from time 
%   tspan(1) to tspan(2) using a fixed step size tau.
%
%   This solver is specifically designed for augmented problems where the 
%   Jacobian or variational equations are solved alongside the main trajectory 
%   to compute the full spectrum of Lyapunov Exponents.
%
%   odefun is a function handle. For a scalar t and a column vector z 
%   (containing both state and flattened tangent vectors), odefun(t,z) 
%   must return a column vector of derivatives f(t,z) for the full augmented system.
%
%   Outputs:
%     t        - Time vector.
%     zsol     - Solution matrix for the augmented state.
%     lyap_exp - Time history of Lyapunov Exponents (accumulated/averaged).
%     dzdt     - Derivatives evaluated at each time point.
%
%   [...] = odeExplicitSolversLyapunovExponents(..., Name, Value) specifies 
%   optional name-value pair arguments:
%
%     'Method' - Specifies the explicit integration algorithm.
%                Default is 'RK4'. Supported methods include:
%
%                Classics:
%                  'RK3'   - Classic Kutta 3rd order
%                  'RK4'   - Classic Runge-Kutta 4th order
%
%                Butcher & Nystrom Series:
%                  'RKN5'  - Nystrom's 5th order
%                  'RKB5'  - Butcher's 5th order
%                  'RKB6'  - Butcher's 6th order
%                  'RKB7'  - Butcher's 7th order
%
%                High-Order Series:
%                  'RKCV8' - Cooper-Verner 8th order
%                  'RKF10' - Feagin's 10th order
%                  'RKF12' - Feagin's 12th order
%                  'RKF14' - Feagin's 14th order
% 
% References
% Butcher, J. (2016). Numerical methods for ordinary differential equations. https://doi.org/10.1002/9781119121534
% Cooper, G. J., & Verner, J. H. (1972). Some explicit Runge"Kutta methods of high order. SIAM Journal on Numerical Analysis, 9(3), 389â€“405. https://doi.org/10.1137/0709037
% Feagin, T. (2007). A tenth-order Runge-Kutta method with error estimate. Proceedings of the IAENG Conf. on Scientific Computing.
% Feagin, T. (2009). An Explicit Runge-Kutta Method of Order Fourteen.
% Feagin, T. (2012). High-order explicit Runge-Kutta methods using m-symmetry. Neural, Parallel & Scientific Computations, 20(3-4), 437-458.

arguments
    odefun function_handle
    tspan (1,2) double
    tau (1,1) double
    incond 
    options.Method (1,1) string {mustBeMember(options.Method, ["RK3", "RK4", "RKB5", "RKN5", "RKB6", "RKB7", "RKCV8", "RKF10", "RKF12", "RKF14"])} = "RK4"
end

switch options.Method
    case "RK3"
        c = [0 1/2 1] .';

        A = [0 0 0;            
            1/2 0 0;            
            -1 2 0];
        
        b = [1/6 2/3 1/6] .';
    case "RK4"
        c = [0 1/2 1/2 1] .'; 

        A = [0 0 0 0; 
            1/2 0 0 0; 
            0 1/2 0 0; 
            0 0 1 0];
        
        b = [1/6 1/3 1/3 1/6] .';
        
    case "RKB5"
        A = zeros(6, 6);
    
        c(1) = 0;
        c(2) = 1/4;
        c(3) = 1/4;
        c(4) = 1/2;
        c(5) = 3/4;
        c(6) = 1;
    
        A(2,1) = 1/4;
    
        A(3,1) = 1/8;
        A(3,2) = 1/8;
    
        A(4,1) = 0;
        A(4,2) = 0;
        A(4,3) = 1/2;
    
        A(5,1) = 3/16;
        A(5,2) = -3/8;
        A(5,3) = 3/8;
        A(5,4) = 9/16;
    
        A(6,1) = -3/7;
        A(6,2) = 8/7;
        A(6,3) = 6/7;
        A(6,4) = -12/7;
        A(6,5) = 8/7;
    
        b(1) = 7/90;
        b(2) = 0;
        b(3) = 32/90;
        b(4) = 12/90;
        b(5) = 32/90;
        b(6) = 7/90;
        
    case "RKN5"
        A = zeros(6, 6);
    
        c(1) = 0;
        c(2) = 1/3;
        c(3) = 2/5;
        c(4) = 1;
        c(5) = 2/3;
        c(6) = 4/5;
    
        A(2,1) = 1/3;
    
        A(3,1) = 4/25;
        A(3,2) = 6/25;
    
        A(4,1) = 1/4;
        A(4,2) = -3;
        A(4,3) = 15/4;
    
        A(5,1) = 2/27;
        A(5,2) = 10/9;
        A(5,3) = -50/81;
        A(5,4) = 8/81;
    
        A(6,1) = 2/25;
        A(6,2) = 12/25;
        A(6,3) = 2/15;
        A(6,4) = 8/75;
        A(6,5) = 0;
    
        b(1) = 23/192;
        b(2) = 0;
        b(3) = 125/192;
        b(4) = 0;
        b(5) = -27/64;
        b(6) = 125/192;

    case "RKB6"
        A = zeros(7, 7);
    
        c(1) = 0;
        c(2) = 1/3;
        c(3) = 2/3;
        c(4) = 1/3;
        c(5) = 5/6;
        c(6) = 1/6;
        c(7) = 1;
    
        A(2,1) = 1/3;
    
        A(3,1) = 0;
        A(3,2) = 2/3;
    
        A(4,1) = 1/12;
        A(4,2) = 1/3;
        A(4,3) = -1/12;
    
        A(5,1) = 25/48;
        A(5,2) = -55/24;
        A(5,3) = 35/48;
        A(5,4) = 15/8;
    
        A(6,1) = 3/20;
        A(6,2) = -11/24;
        A(6,3) = -1/8;
        A(6,4) = 1/2;
        A(6,5) = 1/10;
    
        A(7,1) = -261/260;
        A(7,2) = 33/13;
        A(7,3) = 43/156;
        A(7,4) = -118/39;
        A(7,5) = 32/195;
        A(7,6) = 80/39;
    
        b(1) = 13/200;
        b(2) = 0;
        b(3) = 11/40;
        b(4) = 11/40;
        b(5) = 4/25;
        b(6) = 4/25;
        b(7) = 13/200;

    case "RKB7"
        A = zeros(9, 9);
    
        c(1) = 0;
        c(2) = 1/6;
        c(3) = 1/3;
        c(4) = 1/2;
        c(5) = 2/11;
        c(6) = 2/3;
        c(7) = 6/7;
        c(8) = 0;
        c(9) = 1;
    
        A(2,1) = 1/6;
    
        A(3,1) = 0;
        A(3,2) = 1/3;
    
        A(4,1) = 1/8;
        A(4,2) = 0;
        A(4,3) = 3/8;
    
        A(5,1) = 148/1331;
        A(5,2) = 0;
        A(5,3) = 150/1331;
        A(5,4) = -56/1331;
    
        A(6,1) = -404/243;
        A(6,2) = 0;
        A(6,3) = -170/27;
        A(6,4) = 4024/1701;
        A(6,5) = 10648/1701;
    
        A(7,1) = 2466/2401;
        A(7,2) = 0;
        A(7,3) = 1242/343;
        A(7,4) = -19176/16807;
        A(7,5) = -51909/16807;
        A(7,6) = 1053/2401;
    
        A(8,1) = 5/154;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 96/539;
        A(8,5) = -1815/20384;
        A(8,6) = -405/2464;
        A(8,7) = 49/1144;
    
        A(9,1) = -113/32;
        A(9,2) = 0;
        A(9,3) = -195/22;
        A(9,4) = 32/7;
        A(9,5) = 29403/3584;
        A(9,6) = -729/512;
        A(9,7) = 1029/1408;
        A(9,8) = 21/16;
    
        b(1) = 0;
        b(2) = 0;
        b(3) = 0;
        b(4) = 32/105;
        b(5) = 1771561/6289920;
        b(6) = 243/2560;
        b(7) = 16807/74880;
        b(8) = 77/1440;
        b(9) = 11/270;

    case "RKCV8"
        A = zeros(11, 11);
    
        c(1) = 0;
        c(2) = 1/2;
        c(3) = 1/2;
        c(4) = (7 + sqrt(21)) / 14;
        c(5) = (7 + sqrt(21)) / 14;
        c(6) = 1/2;
        c(7) = (7 - sqrt(21)) / 14;
        c(8) = (7 - sqrt(21)) / 14;
        c(9) = 1/2;
        c(10) = (7 + sqrt(21)) / 14;
        c(11) = 1;
    
        A(2,1) = 1/2;
    
        A(3,1) = 1/4;
        A(3,2) = 1/4;
    
        A(4,1) = 1/7;
        A(4,2) = (-7 - 3*sqrt(21)) / 98;
        A(4,3) = (21 + 5*sqrt(21)) / 49;
    
        A(5,1) = (11 + sqrt(21)) / 84;
        A(5,2) = 0;
        A(5,3) = (18 + 4*sqrt(21)) / 63;
        A(5,4) = (21 - sqrt(21)) / 252;
    
        A(6,1) = (5 + sqrt(21)) / 48;
        A(6,2) = 0;
        A(6,3) = (9 + sqrt(21)) / 36;
        A(6,4) = (-231 + 14*sqrt(21)) / 360;
        A(6,5) = (63 - 7*sqrt(21)) / 80;
    
        A(7,1) = (10 - sqrt(21)) / 42;
        A(7,2) = 0;
        A(7,3) = (-432 + 92*sqrt(21)) / 315;
        A(7,4) = (633 - 145*sqrt(21)) / 90;
        A(7,5) = (-504 + 115*sqrt(21)) / 70;
        A(7,6) = (63 - 13*sqrt(21)) / 35;
    
        A(8,1) = 1/14;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = (14 - 3*sqrt(21)) / 126;
        A(8,6) = (13 - 3*sqrt(21)) / 63;
        A(8,7) = 1/9;
    
        A(9,1) = 1/32;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = (91 - 21*sqrt(21)) / 576;
        A(9,6) = 11/72;
        A(9,7) = (-385 - 75*sqrt(21)) / 1152;
        A(9,8) = (63 + 13*sqrt(21)) / 128;
    
        A(10,1) = 1/14;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 1/9;
        A(10,6) = (-733 - 147*sqrt(21)) / 2205;
        A(10,7) = (515 + 111*sqrt(21)) / 504;
        A(10,8) = (-51 - 11*sqrt(21)) / 56;
        A(10,9) = (132 + 28*sqrt(21)) / 245;

        A(11,1) = 0;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = (-42 + 7*sqrt(21)) / 18;
        A(11,6) = (-18 + 28*sqrt(21)) / 45;
        A(11,7) = (-273 - 53*sqrt(21)) / 72;
        A(11,8) = (301 + 53*sqrt(21)) / 72;
        A(11,9) = (28 - 28*sqrt(21)) / 45;
        A(11,10)= (49 - 7*sqrt(21)) / 18;
    
        b(1) = 1/20;
        b(2) = 0;
        b(3) = 0;
        b(4) = 0;
        b(5) = 0;
        b(6) = 0;
        b(7) = 0;
        b(8) = 49/180;
        b(9) = 16/45;
        b(10) = 49/180;
        b(11) = 1/20;

    case "RKF10"
        A = zeros(17, 17);

        c(1) = 0;
        c(2) = 1/10;
        c(3) = 0.53935784080298178753248519788130;
        c(4) = 0.80903676120447268129872779682195;
        c(5) = 0.30903676120447268129872779682195;
        c(6) = 0.98107419021979526825487954831056;
        c(7) = 5/6;
        c(8) = 0.35401736585680237632926418594880;
        c(9) = 0.88252766196473234642550148697967;
        c(10) = 0.64261575824032254815707549702044;
        c(11) = 0.35738424175967745184292450297956;
        c(12) = 0.11747233803526765357449851302033;
        c(13) = 5/6;
        c(14) = 0.30903676120447268129872779682195;
        c(15) = 0.53935784080298178753248519788130;
        c(16) = 1/10;
        c(17) = 1;
    
        A(2,1) = 1/10;
    
        A(3,1) = -0.91517656137529144052001501927534;
        A(3,2) = 1.45453440217827322805250021715664;
    
        A(4,1) = 0.20225919030111817032468194920549;
        A(4,2) = 0;
        A(4,3) = 0.60677757090335451097404584761647;
    
        A(5,1) = 0.18402471470864357514910069347112;
        A(5,2) = 0;
        A(5,3) = 0.19796683122719236906814177051039;
        A(5,4) = -0.07295478473136326291851466715956;
    
        A(6,1) = 0.08790073402066813373197770941321;
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 0.41045970252026064531817489592045;
        A(6,5) = 0.48271375367886648920472694297690;
    
        A(7,1) = 0.08597005049024603021884802259458;
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = 0.33088596304072218394888405765875;
        A(7,5) = 0.48966295730945019284450701113590;
        A(7,6) = -0.07318563750708507367890575805590;
    
        A(8,1) = 0.12093044912533372066037885492767;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0.26012467575829562280900761783834;
        A(8,6) = 0.03254026215490913301588993343912;
        A(8,7) = -0.05957802118173610015601222025633;
    
        A(9,1) = 0.11085437958039148350893617101022;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = -0.06057614882550055876209249536555;
        A(9,7) = 0.32176370560177839010089879904988;
        A(9,8) = 0.51048572560806303157775901228512;
    
        A(10,1) = 0.11205441475287900482971500276180;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = -0.14494277590286591567234982834098;
        A(10,7) = -0.33326971909625670658970521141575;
        A(10,8) = 0.49926922955688006135331684396998;
        A(10,9) = 0.50950460892968610423609869004539;
    
        A(11,1) = 0.11397678396418598613800418673690;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = -0.07688133642033569385862142891209;
        A(11,7) = 0.23952736032439064910771145527188;
        A(11,8) = 0.39777466236809463904783046248895;
        A(11,9) = 0.01075589568736074555506091474415;
        A(11,10) = -0.32776912416401887414706108735023;
    
        A(12,1) = 0.07983145282801960463514268644864;
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = -0.05203296868006030765149498876130;
        A(12,7) = -0.05769541461685488817327843552834;
        A(12,8) = 0.19478191571210416497630626214738;
        A(12,9) = 0.14538492318832506972752482597707;
        A(12,10) = -0.07829427103516707775539867297257;
        A(12,11) = -0.11450329936109891218430316429055;
    
        A(13,1) = 0.98511561016485728012004150030652;
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0.33088596304072218394888405765875;
        A(13,5) = 0.48966295730945019284450701113590;
        A(13,6) = -1.37896486574843567582112720930752;
        A(13,7) = -0.86116419502763566667391699966553;
        A(13,8) = 5.78428813637537220022999785486578;
        A(13,9) = 3.28807761985103566890460615937315;
        A(13,10) = -2.38633905093136384013422325215528;
        A(13,11) = -3.25479342483643918654589367587789;
        A(13,12) = -2.16343541686422982353954211300055;
    
        A(14,1) = 0.89508029577163289104961313233659;
        A(14,2) = 0;
        A(14,3) = 0.19796683122719236906814177051039;
        A(14,4) = -0.07295478473136326291851466715956;
        A(14,5) = 0;
        A(14,6) = -0.85123623966200761973904937144597;
        A(14,7) = 0.39832011231853330171971861417437;
        A(14,8) = 3.63937263181035606029412920047090;
        A(14,9) = 1.54822877039830322365301663075175;
        A(14,10) = -2.12221714704053716026062427460427;
        A(14,11) = -1.58350398545326172713384349625753;
        A(14,12) = -1.71561608285936264922031819751349;
        A(14,13) = -0.02440364057501274521354154444122;
    
        A(15,1) = -0.91517656137529144052001501927534;
        A(15,2) = 1.45453440217827322805250021715664;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = -0.77733364364496823353893122857530;
        A(15,6) = 0;
        A(15,7) = -0.09108956621551760695932035558075;
        A(15,8) = 0;
        A(15,9) = 0;
        A(15,10) = 0;
        A(15,11) = 0;
        A(15,12) = 0;
        A(15,13) = 0.09108956621551760695932035558075;
        A(15,14) = 0.77733364364496823353893122857530;
    
        A(16,1) = 1/10;
        A(16,2) = 0;
        A(16,3) = -0.15717866579977116336705899827313;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 0;
        A(16,7) = 0;
        A(16,8) = 0;
        A(16,9) = 0;
        A(16,10) = 0;
        A(16,11) = 0;
        A(16,12) = 0;
        A(16,13) = 0;
        A(16,14) = 0;
        A(16,15) = 0.15717866579977116336705899827313;
    
        A(17,1) = 0.18178130070009528388847206258226;
        A(17,2) = 27/40;
        A(17,3) = 0.34275815984718983994222055341385;
        A(17,4) = 0;
        A(17,5) = 0.25911121454832274451297707619177;
        A(17,6) = -0.35827896671795208904896127672198;
        A(17,7) = -1.04594895940883306095050068756410;
        A(17,8) = 0.93032784541562698329230056443243;
        A(17,9) = 1.77950959431708102446142106794824;
        A(17,10) = 1/10;
        A(17,11) = -0.28254756953904408161247778522229;
        A(17,12) = -0.15932735011997254916926198437349;
        A(17,13) = -0.14551589464700151086099196108108;
        A(17,14) = -0.25911121454832274451297707619177;
        A(17,15) = -0.34275815984718983994222055341385;
        A(17,16) = -27/40;
    
        b(1) = 1/30;
        b(2) = 1/40;
        b(3) = 1/30;
        b(4) = 0;
        b(5) = 1/20;
        b(6) = 0;
        b(7) = 1/25;
        b(8) = 0;
        b(9) = 0.18923747814892349015830640410601;
        b(10) = 0.27742918851774317650836026256065;
        b(11) = 0.27742918851774317650836026256065;
        b(12) = 0.18923747814892349015830640410601;
        b(13) = -1/25;
        b(14) = -1/20;
        b(15) = -1/30;
        b(16) = -1/40;
        b(17) = 1/30;

    case "RKF12"
        A = zeros(25, 25);

        c(1) = 0;
        c(2) = 1/5;
        c(3) = 5/9;
        c(4) = 5/6;
        c(5) = 1/3;
        c(6) = 1;
        c(7) = 0.67183570917051381271224566100280;
        c(8) = 0.28872494111062020193545848896702;
        c(9) = 9/16;
        c(10) = 5/6;
        c(11) = 0.94769543117919928756238016210184;
        c(12) = 0.05481128768638026438877536748108;
        c(13) = 0.08488805186071653506398389301627;
        c(14) = 0.26557560326464289309811405904562;
        c(15) = 1/2;
        c(16) = 0.73442439673535710690188594095438;
        c(17) = 0.91511194813928346493601610698373;
        c(18) = 0.94769543117919928756238016210184;
        c(19) = 5/6;
        c(20) = 0.28872494111062020193545848896702;
        c(21) = 0.67183570917051381271224566100280;
        c(22) = 1/3;
        c(23) = 5/9;
        c(24) = 1/5;
        c(25) = 1;
    
        A(2,1) = 1/5;

        A(3,1) = -0.21604938271604938271604938271605;
        A(3,2) = 0.77160493827160493827160493827160;
    
        A(4,1) = 5/24;
        A(4,2) = 0;
        A(4,3) = 5/8;
    
        A(5,1) = 29/150;
        A(5,2) = 0;
        A(5,3) = 11/50;
        A(5,4) = -2/25;
    
        A(6,1) = 1/10;
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 2/5;
        A(6,5) = 1/2;
    
        A(7,1) = 0.10336447165001047757039543569048;
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = 0.12405309452894676106158188923712;
        A(7,5) = 0.48317116756103289928883648045196;
        A(7,6) = -0.03875302456947632520856814437676;
    
        A(8,1) = 0.12403826143183332408190458598018;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0.21705063219795848631784625695316;
        A(8,6) = 0.01374557920759667598129078018350;
        A(8,7) = -0.06610953172676828444558313414981;
    
        A(9,1) = 0.09147748948568829831449918469804;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = -0.00544348523717469689965754944145;
        A(9,7) = 0.06807168016884535185785151208951;
        A(9,8) = 0.40839431558264104672730685265389;
    
        A(10,1) = 0.08900136525025510189545093554238;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = 0.00499528226645532360197793408421;
        A(10,7) = 0.39791823881982899734173960300135;
        A(10,8) = 0.42793021075257661106819260830090;
        A(10,9) = -0.08651176375578270057402774759550;
    
        A(11,1) = 0.06950876241349075431126939064098;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = 0.12914694190017646197075957948275;
        A(11,7) = 1.53073638102311295076342566143215;
        A(11,8) = 0.57787476112914005254675134945458;
        A(11,9) = -0.95129477232108898053234083738886;
        A(11,10) = -0.40827664296563195149748498151976;
    
        A(12,1) = 0.04448614032951358662694535070925;
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = -0.00380476867056961731984232686575;
        A(12,7) = 0.01069550640296242007212626028091;
        A(12,8) = 0.02096162444999043332966742059289;
        A(12,9) = -0.02331460232593217866485614315520;
        A(12,10) = 0.00263265981064536974369934736325;
        A(12,11) = 0.00315472768977025060103545855572;
    
        A(13,1) = 0.01945888151197554755888010965253;
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0;
        A(13,5) = 0;
        A(13,6) = 0;
        A(13,7) = 0;
        A(13,8) = 0;
        A(13,9) = 0.00006785129491718125093061216535;
        A(13,10) = -0.00004297958590492736232710053302;
        A(13,11) = 0.00001763589822602851554074859290;
        A(13,12) = 0.06538666274150270510095952313852;
    
        A(14,1) = 0.20683683566427710591682817479827;
        A(14,2) = 0;
        A(14,3) = 0;
        A(14,4) = 0;
        A(14,5) = 0;
        A(14,6) = 0;
        A(14,7) = 0;
        A(14,8) = 0;
        A(14,9) = 0.01667960671041564728280458666647;
        A(14,10) = -0.00879501563200710214457024178250;
        A(14,11) = 0.00346675455362463910824462315246;
        A(14,12) = -0.86126446010571767816143256225835;
        A(14,13) = 0.90865188207405028109623947846926;
    
        A(15,1) = 0.02039260846544840100915113146769;
        A(15,2) = 0;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = 0;
        A(15,6) = 0;
        A(15,7) = 0;
        A(15,8) = 0;
        A(15,9) = 0.08694693920166859486754005555839;
        A(15,10) = -0.01916496304101498422864366117914;
        A(15,11) = 0.00655629159493663287364871573244;
        A(15,12) = 0.09874761281274347809037985286740;
        A(15,13) = 0.00535364695524996055083260173616;
        A(15,14) = 0.30116786401096791683709130381705;
    
        A(16,1) = 0.22841043391777809954711541289300;
        A(16,2) = 0;
        A(16,3) = 0;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 0;
        A(16,7) = 0;
        A(16,8) = 0;
        A(16,9) = -0.49870740079302525063501656744251;
        A(16,10) = 0.13484116833572447855259670379257;
        A(16,11) = -0.03874582440558341584399042269240;
        A(16,12) = -1.27473257473474844240388430824909;
        A(16,13) = 1.43916364462877165201184452437038;
        A(16,14) = -0.21400746796799025421950354082735;
        A(16,15) = 0.95820241775443023989272413910978;
    
        A(17,1) = 2.00222477655974203614249646012507;
        A(17,2) = 0;
        A(17,3) = 0;
        A(17,4) = 0;
        A(17,5) = 0;
        A(17,6) = 0;
        A(17,7) = 0;
        A(17,8) = 0;
        A(17,9) = 2.06701809961524912091954656438139;
        A(17,10) = 0.62397813608613954195747127983149;
        A(17,11) = -0.04622836855003114302832035541291;
        A(17,12) = -8.84973288362649614860075246727119;
        A(17,13) = 7.74257707850855976227437225791836;
        A(17,14) = -0.58835851925086921099335331412771;
        A(17,15) = -1.10683733362380649395704708016953;
        A(17,16) = -0.92952903757920399977839723829123;
    
        A(18,1) = 3.13789533412073442934451608989889;
        A(18,2) = 0;
        A(18,3) = 0;
        A(18,4) = 0;
        A(18,5) = 0;
        A(18,6) = 0.12914694190017646197075957948275;
        A(18,7) = 1.53073638102311295076342566143215;
        A(18,8) = 0.57787476112914005254675134945458;
        A(18,9) = 5.42088263055126683050056840891857;
        A(18,10) = 0.23154692603482930487266380087764;
        A(18,11) = 0.07592929955789135601623013117853;
        A(18,12) = -12.37299733801865132874145534025958;
        A(18,13) = 9.85455883464769543935957209317369;
        A(18,14) = 0.08591114313704365295793577090524;
        A(18,15) = -5.65242752862643921117182090081763;
        A(18,16) = -1.94300935242819610883833776782364;
        A(18,17) = -0.12835260184940454201842871431934;
    
        A(19,1) = 1.38360054432196014878538118298168;
        A(19,2) = 0;
        A(19,3) = 0;
        A(19,4) = 0;
        A(19,5) = 0;
        A(19,6) = 0.00499528226645532360197793408421;
        A(19,7) = 0.39791823881982899734173960300135;
        A(19,8) = 0.42793021075257661106819260830090;
        A(19,9) = -1.30299107424475770916551439123048;
        A(19,10) = 0.66129227866937702909711252810751;
        A(19,11) = -0.14455977430695434976596939368870;
        A(19,12) = -6.96576034731798203467853867461084;
        A(19,13) = 6.65808543235991748353408295542210;
        A(19,14) = -1.66997375108841486404695805725511;
        A(19,15) = 2.06413702318035263832289040301833;
        A(19,16) = -0.67474396264430647186295812957084;
        A(19,17) = -0.00115618834794939500490703608436;
        A(19,18) = -0.00544057908677007389319819914242;
    
        A(20,1) = 0.95123629704828766947463797589497;
        A(20,2) = 0;
        A(20,3) = 0;
        A(20,4) = 0;
        A(20,5) = 0.21705063219795848631784625695316;
        A(20,6) = 0.01374557920759667598129078018350;
        A(20,7) = -0.06610953172676828444558313414981;
        A(20,8) = 0;
        A(20,9) = 0.15228169673641444713660469704075;
        A(20,10) = -0.33774101835759984080230079313400;
        A(20,11) = -0.01928259816339957815349491992868;
        A(20,12) = -3.68259269696866809932409015535500;
        A(20,13) = 3.16197870406982063541533528419684;
        A(20,14) = -0.37046252210688529071699185602205;
        A(20,15) = -0.05149742003654404349964344566981;
        A(20,16) = -0.00082962553212015294678704354179;
        A(20,17) = 0.00000279801041419278598986586589;
        A(20,18) = 0.04186039164123602879698410207768;
        A(20,19) = 0.27908425509087735591566087455538;
    
        A(21,1) = 0.10336447165001047757039543569048;
        A(21,2) = 0;
        A(21,3) = 0;
        A(21,4) = 0.12405309452894676106158188923712;
        A(21,5) = 0.48317116756103289928883648045196;
        A(21,6) = -0.03875302456947632520856814437676;
        A(21,7) = 0;
        A(21,8) = -0.43831382036112242039105978894096;
        A(21,9) = 0;
        A(21,10) = -0.21863663372167664768511148501715;
        A(21,11) = -0.03123347643947192299816349952064;
        A(21,12) = 0;
        A(21,13) = 0;
        A(21,14) = 0;
        A(21,15) = 0;
        A(21,16) = 0;
        A(21,17) = 0;
        A(21,18) = 0.03123347643947192299816349952064;
        A(21,19) = 0.21863663372167664768511148501715;
        A(21,20) = 0.43831382036112242039105978894096;
    
        A(22,1) = 29/150;
        A(22,2) = 0;
        A(22,3) = 11/50;
        A(22,4) = -2/25;
        A(22,5) = 0;
        A(22,6) = 0;
        A(22,7) = 0.09842561304993159281529002868560;
        A(22,8) = -0.19641088922305465344652650439010;
        A(22,9) = 0;
        A(22,10) = 0.43645793049306872939182612258795;
        A(22,11) = 0.06526137216757210985603709398056;
        A(22,12) = 0;
        A(22,13) = 0;
        A(22,14) = 0;
        A(22,15) = 0;
        A(22,16) = 0;
        A(22,17) = 0;
        A(22,18) = -0.06526137216757210985603709398056;
        A(22,19) = -0.43645793049306872939182612258795;
        A(22,20) = 0.19641088922305465344652650439010;
        A(22,21) = -0.09842561304993159281529002868560;
    
        A(23,1) = -0.21604938271604938271604938271605;
        A(23,2) = 0.77160493827160493827160493827160;
        A(23,3) = 0;
        A(23,4) = 0;
        A(23,5) = -2/3;
        A(23,6) = 0;
        A(23,7) = -0.39069646929597845144699980225850;
        A(23,8) = 0;
        A(23,9) = 0;
        A(23,10) = 0;
        A(23,11) = 0;
        A(23,12) = 0;
        A(23,13) = 0;
        A(23,14) = 0;
        A(23,15) = 0;
        A(23,16) = 0;
        A(23,17) = 0;
        A(23,18) = 0;
        A(23,19) = 0;
        A(23,20) = 0;
        A(23,21) = 0.39069646929597845144699980225850;
        A(23,22) = 2/3;
    
        A(24,1) = 1/5;
        A(24,2) = 0;
        A(24,3) = -0.16460905349794238683127572016461;
        A(24,4) = 0;
        A(24,5) = 0;
        A(24,6) = 0;
        A(24,7) = 0;
        A(24,8) = 0;
        A(24,9) = 0;
        A(24,10) = 0;
        A(24,11) = 0;
        A(24,12) = 0;
        A(24,13) = 0;
        A(24,14) = 0;
        A(24,15) = 0;
        A(24,16) = 0;
        A(24,17) = 0;
        A(24,18) = 0;
        A(24,19) = 0;
        A(24,20) = 0;
        A(24,21) = 0;
        A(24,22) = 0;
        A(24,23) = 0.16460905349794238683127572016461;
    
        A(25,1) = 1.47178724881110408452949550989024;
        A(25,2) = 63/80;
        A(25,3) = 91/216;
        A(25,4) = 0;
        A(25,5) = 7/24;
        A(25,6) = 0;
        A(25,7) = 0.34860071762832956320685442162966;
        A(25,8) = 0.22949954476899484958289023371056;
        A(25,9) = 5.79046485790481979159831978177003;
        A(25,10) = 0.41858751185650686887407375942660;
        A(25,11) = 0.30703988022247400264965381749011;
        A(25,12) = -4.68700905350603332214256344683853;
        A(25,13) = 3.13571665593802262152038152399874;
        A(25,14) = 1.40134829710965720817510506275620;
        A(25,15) = -5.52931101439499023629010306005764;
        A(25,16) = -0.85313823550806334930954689497478;
        A(25,17) = 0.10357578037361014041180460716777;
        A(25,18) = -0.14047441695060094114254690120213;
        A(25,19) = -0.41858751185650686887407375942660;
        A(25,20) = -0.22949954476899484958289023371056;
        A(25,21) = -0.34860071762832956320685442162966;
        A(25,22) = -7/24;
        A(25,23) = -91/216;
        A(25,24) = -63/80;

        b(1) = 1/42;
        b(2) = 234375/10000000;
        b(3) = 3125/100000;
        b(4) = 0;
        b(5) = 1/24;
        b(6) = 0;
        b(7) = 1/20;
        b(8) = 1/20;
        b(9) = 0;
        b(10) = 1/10;
        b(11) = 1/14;
        b(12) = 0;
        b(13) = 0.13841302368078297400535020314503;
        b(14) = 0.21587269060493131170893551114068;
        b(15) = 0.24380952380952380952380952380952;
        b(16) = 0.21587269060493131170893551114068;
        b(17) = 0.13841302368078297400535020314503;
        b(18) = -0.07142857142857142857142857142857;
        b(19) = -1/10;
        b(20) = -1/20;
        b(21) = -1/20;
        b(22) = -1/24;
        b(23) = -3125/100000;
        b(24) = -234375/10000000;
        b(25) = 1/42;

    case "RKF14"
        A = zeros(35, 35);

        c(1) = 0;
        c(2) = 1/9;
        c(3) = 5/9;
        c(4) = 5/6;
        c(5) = 1/3;
        c(6) = 1;
        c(7) = 0.66998697927277292176468378550600;
        c(8) = 0.29706838421381835738958471680822;
        c(9) = 8/11;
        c(10) = 0.14015279904218876527618748796695;
        c(11) = 0.70070103977015073715109985483075;
        c(12) = 4/11;
        c(13) = 0.26315789473684210526315789473684;
        c(14) = 0.03921722466502708591251966425012;
        c(15) = 0.81291750292837676298339315927804;
        c(16) = 1/6;
        c(17) = 9/10;
        c(18) = 0.06412992574519669233127711938967;
        c(19) = 0.20414990928342884892774463430102;
        c(20) = 0.39535039104876056561567136982732;
        c(21) = 0.60464960895123943438432863017268;
        c(22) = 0.79585009071657115107225536569898;
        c(23) = 0.93587007425480330766872288061033;
        c(24) = 1/6;
        c(25) = 0.81291750292837676298339315927804;
        c(26) = 0.03921722466502708591251966425012;
        c(27) = 4/11;
        c(28) = 0.70070103977015073715109985483075;
        c(29) = 0.14015279904218876527618748796695;
        c(30) = 0.29706838421381835738958471680822;
        c(31) = 0.66998697927277292176468378550600;
        c(32) = 1/3;
        c(33) = 5/9;
        c(34) = 1/9;
        c(35) = 1;
    
        A(2,1) = 1/9;
    
        A(3,1) = -5/6;
        A(3,2) = 25/18;
    
        A(4,1) = 5/24;
        A(4,2) = 0;
        A(4,3) = 5/8;
    
        A(5,1) = 29/150;
        A(5,2) = 0;
        A(5,3) = 11/50;
        A(5,4) = -2/25;
    
        A(6,1) = 1/10;
        A(6,2) = 0;
        A(6,3) = 0;
        A(6,4) = 2/5;
        A(6,5) = 1/2;
    
        A(7,1) = 0.10348456163667977667299354651191;
        A(7,2) = 0;
        A(7,3) = 0;
        A(7,4) = 0.12206888730640722258964408286896;
        A(7,5) = 0.48257449033124662247513478012569;
        A(7,6) = -0.03814096000156069997308862400056;
    
        A(8,1) = 0.12438052665409441288151642086880;
        A(8,2) = 0;
        A(8,3) = 0;
        A(8,4) = 0;
        A(8,5) = 0.22612028219758430142223866297920;
        A(8,6) = 0.01378858876180808806076958370165;
        A(8,7) = -0.06722101339966844497493995074143;
    
        A(9,1) = 0.09369190656596738155308854560830;
        A(9,2) = 0;
        A(9,3) = 0;
        A(9,4) = 0;
        A(9,5) = 0;
        A(9,6) = -0.00613406843450510987229498995642;
        A(9,7) = 0.21601982562550306370886009765987;
        A(9,8) = 0.42369506351576193733761907396098;
    
        A(10,1) = 0.08384798124090526646169687913728;
        A(10,2) = 0;
        A(10,3) = 0;
        A(10,4) = 0;
        A(10,5) = 0;
        A(10,6) = -0.01179493671009738143197550560313;
        A(10,7) = -0.24729902056881265233947383874319;
        A(10,8) = 0.09780808583677290122593130140813;
        A(10,9) = 0.21759068924342063136000865176786;
    
        A(11,1) = 0.06152553597694282279545623896143;
        A(11,2) = 0;
        A(11,3) = 0;
        A(11,4) = 0;
        A(11,5) = 0;
        A(11,6) = 0.00592232780324503308042990005798;
        A(11,7) = 0.47032615996384111221722430320589;
        A(11,8) = 0.29968886384867900085398183709619;
        A(11,9) = -0.24765687759399491468999227632981;
        A(11,10) = 0.11089502977143768289399985183906;
    
        A(12,1) = 0.04197000733627825798617928647873;
        A(12,2) = 0;
        A(12,3) = 0;
        A(12,4) = 0;
        A(12,5) = 0;
        A(12,6) = -0.00317987696266205093901912847693;
        A(12,7) = 0.80639771490619207726082171152038;
        A(12,8) = 0.09759831264123889790935228506843;
        A(12,9) = 0.77857557815839890902751244645293;
        A(12,10) = 0.20489042383159942818949920209811;
        A(12,11) = -1.56261579627468188307070943950528;
    
        A(13,1) = 0.04377267822337301635744652424953;
        A(13,2) = 0;
        A(13,3) = 0;
        A(13,4) = 0;
        A(13,5) = 0;
        A(13,6) = 0;
        A(13,7) = 0;
        A(13,8) = 0;
        A(13,9) = 0.00624365027520195208794358628581;
        A(13,10) = 0.20004309710957731499443516546965;
        A(13,11) = -0.00805328367804983036823857162049;
        A(13,12) = 0.02115175280673965219157119035234;
    
        A(14,1) = 0.02834992503635145630950235919207;
        A(14,2) = 0;
        A(14,3) = 0;
        A(14,4) = 0;
        A(14,5) = 0;
        A(14,6) = 0;
        A(14,7) = 0;
        A(14,8) = 0;
        A(14,9) = 0.00249163204855817407538949148806;
        A(14,10) = 0.02301387878545931496383998463737;
        A(14,11) = -0.00322155956692977098724476092467;
        A(14,12) = 0.00988442549447664668946335414488;
        A(14,13) = -0.02130107713288873513843076428759;
    
        A(15,1) = 0.34351189429024300104943223473515;
        A(15,2) = 0;
        A(15,3) = 0;
        A(15,4) = 0;
        A(15,5) = 0;
        A(15,6) = 0;
        A(15,7) = 0;
        A(15,8) = 0;
        A(15,9) = 0.21045191202362738560909701199901;
        A(15,10) = 1.03427452057230411936482926828826;
        A(15,11) = 0.00600303645864422487051240448207;
        A(15,12) = 0.85593812509961953757801210600241;
        A(15,13) = -0.97723500503676681087226485237253;
        A(15,14) = -0.66002698047929469461622501385633;
    
        A(16,1) = -0.01435740016721680695382063999351;
        A(16,2) = 0;
        A(16,3) = 0;
        A(16,4) = 0;
        A(16,5) = 0;
        A(16,6) = 0;
        A(16,7) = 0;
        A(16,8) = 0;
        A(16,9) = -0.03662532700490399702936857968490;
        A(16,10) = 0.03502549756362136819768494069798;
        A(16,11) = 0.03609460163621135089317866587583;
        A(16,12) = -0.02652199675536811063515959468346;
        A(16,13) = 0.04456990113056981196389115375088;
        A(16,14) = 0.12434309333135824328622559574179;
        A(16,15) = 0.00413829693239480694403512496204;
    
        A(17,1) = 0.35603240442512029097560911639809;
        A(17,2) = 0;
        A(17,3) = 0;
        A(17,4) = 0;
        A(17,5) = 0;
        A(17,6) = 0;
        A(17,7) = 0;
        A(17,8) = 0;
        A(17,9) = -0.45019275894756259596682177907596;
        A(17,10) = 0.43052790708371089862665629280878;
        A(17,11) = 0.51197302901102223766855696039407;
        A(17,12) = 0.90830363888640426039015912463811;
        A(17,13) = -1.23921093371933931757372469151534;
        A(17,14) = -0.64904866167176146514167234887906;
        A(17,15) = 0.25170890458681929221048052994897;
        A(17,16) = 0.77990647034558639881075679528233;
    
        A(18,1) = 0.01309356874065130664068812064188;
        A(18,2) = 0;
        A(18,3) = 0;
        A(18,4) = 0;
        A(18,5) = 0;
        A(18,6) = 0;
        A(18,7) = 0;
        A(18,8) = 0;
        A(18,9) = 0;
        A(18,10) = 0;
        A(18,11) = 0;
        A(18,12) = 0;
        A(18,13) = -0.00009320530679851139459084619628;
        A(18,14) = 0.05053743342622993596400904431386;
        A(18,15) = 0.00000080447034194448797910957911;
        A(18,16) = 0.00059172602949417119052875574278;
        A(18,17) = -0.00000040161472215455733706469168;
    
        A(19,1) = 0.02079264844660530125419445440008;
        A(19,2) = 0;
        A(19,3) = 0;
        A(19,4) = 0;
        A(19,5) = 0;
        A(19,6) = 0;
        A(19,7) = 0;
        A(19,8) = 0;
        A(19,9) = 0;
        A(19,10) = 0;
        A(19,11) = 0;
        A(19,12) = 0;
        A(19,13) = 0.00058269591880008591510190269784;
        A(19,14) = -0.00801700732358815939083342186526;
        A(19,15) = 0.00000403847643847136940375170822;
        A(19,16) = 0.08546099980555061442250561145675;
        A(19,17) = -0.00000204486480935804242706707570;
        A(19,18) = 0.10532857882443189339979940297909;
    
        A(20,1) = 1.40153449795736021415446247355771;
        A(20,2) = 0;
        A(20,3) = 0;
        A(20,4) = 0;
        A(20,5) = 0;
        A(20,6) = 0;
        A(20,7) = 0;
        A(20,8) = 0;
        A(20,9) = 0;
        A(20,10) = 0;
        A(20,11) = 0;
        A(20,12) = 0;
        A(20,13) = -0.23025200098422126161627241036742;
        A(20,14) = -7.21106840466912905659582237106874;
        A(20,15) = 0.00372901560694836335236995327852;
        A(20,16) = -4.71415495727125020678778179392225;
        A(20,17) = -0.00176367657545349242053841995033;
        A(20,18) = 7.64130548038698765563029310880238;
        A(20,19) = 3.50602043659751834989896082949745;
    
        A(21,1) = 11.95146506941206867993723858307164;
        A(21,2) = 0;
        A(21,3) = 0;
        A(21,4) = 0;
        A(21,5) = 0;
        A(21,6) = 0;
        A(21,7) = 0;
        A(21,8) = 0;
        A(21,9) = 0;
        A(21,10) = 0;
        A(21,11) = 0;
        A(21,12) = 0;
        A(21,13) = 7.79480932108175968783516700231764;
        A(21,14) = -56.45013938673257925235609911209043;
        A(21,15) = 0.09123763069306449013445304492903;
        A(21,16) = -12.73362799254348862019455243091993;
        A(21,17) = -0.03968959219047197123135428109397;
        A(21,18) = 54.43921418835708869962257651553078;
        A(21,19) = -3.64411637921569236846406990361351;
        A(21,20) = -0.80450324991050991089903078795858;
    
        A(22,1) = -148.80942650710048842783886826864763;
        A(22,2) = 0;
        A(22,3) = 0;
        A(22,4) = 0;
        A(22,5) = 0;
        A(22,6) = 0;
        A(22,7) = 0;
        A(22,8) = 0;
        A(22,9) = 0;
        A(22,10) = 0;
        A(22,11) = 0;
        A(22,12) = 0;
        A(22,13) = -91.72952782912564843579356624023216;
        A(22,14) = 707.65614497159835983457571928633572;
        A(22,15) = -1.10563611857482440905296961311591;
        A(22,16) = 176.13459188381137258785989807605566;
        A(22,17) = 0.49138482421488066226889834516445;
        A(22,18) = -684.27800044981494435823753561089508;
        A(22,19) = 27.99106049983982589842243321243804;
        A(22,20) = 13.19397100302823334436709643711532;
        A(22,21) = 1.25128781283980445450114974148056;
    
        A(23,1) = -9.67307946948196763644126118433219;
        A(23,2) = 0;
        A(23,3) = 0;
        A(23,4) = 0;
        A(23,5) = 0;
        A(23,6) = 0;
        A(23,7) = 0;
        A(23,8) = 0;
        A(23,9) = 0;
        A(23,10) = 0;
        A(23,11) = 0;
        A(23,12) = 0;
        A(23,13) = -4.46990150858505531443846227701960;
        A(23,14) = 45.51271286909526819682419504000528;
        A(23,15) = -0.07130850861838269127914920244382;
        A(23,16) = 11.22736140684127415825906244799394;
        A(23,17) = 0.12624437671762272451623791290914;
        A(23,18) = -43.54393395494833136058106249072421;
        A(23,19) = 0.78717430754305897839879299499655;
        A(23,20) = 0.53226469674468421566930070860389;
        A(23,21) = 0.42242273399632532601022512747139;
        A(23,22) = 0.08591312495030671073084380314999;
    
        A(24,1) = -10.06640324470547024033966069004269;
        A(24,2) = 0;
        A(24,3) = 0;
        A(24,4) = 0;
        A(24,5) = 0;
        A(24,6) = 0;
        A(24,7) = 0;
        A(24,8) = 0;
        A(24,9) = -0.03662532700490399702936857968490;
        A(24,10) = 0.03502549756362136819768494069798;
        A(24,11) = 0.03609460163621135089317866587583;
        A(24,12) = -0.02652199675536811063515959468346;
        A(24,13) = -6.27088972181464143590553149478872;
        A(24,14) = 48.20792374425629890907021030081951;
        A(24,15) = -0.06944716891361656408823951805837;
        A(24,16) = 12.68106902048502956983413709136098;
        A(24,17) = 0.01196711689683237548381614355010;
        A(24,18) = -46.72497649924824080033582682426627;
        A(24,19) = 1.33029613326626711314710039298217;
        A(24,20) = 1.00766787503398298353438903619927;
        A(24,21) = 0.02095120519336650916641223884755;
        A(24,22) = 0.02101347063312641773177354243314;
        A(24,23) = 0.00952196014417121794175101542455;
    
        A(25,1) = -409.47808167774370877258909740937036;
        A(25,2) = 0;
        A(25,3) = 0;
        A(25,4) = 0;
        A(25,5) = 0;
        A(25,6) = 0;
        A(25,7) = 0;
        A(25,8) = 0;
        A(25,9) = 0.21045191202362738560909701199901;
        A(25,10) = 1.03427452057230411936482926828826;
        A(25,11) = 0.00600303645864422487051240448207;
        A(25,12) = 0.85593812509961953757801210600241;
        A(25,13) = -250.51699854744786049277765772931613;
        A(25,14) = 1946.42466652388427766053750328264759;
        A(25,15) = -3.04503882102310365506105809086861;
        A(25,16) = 490.62637952828171352120826529916808;
        A(25,17) = 1.56647589531270907115484067013597;
        A(25,18) = -1881.97428994011173362217267377035871;
        A(25,19) = 75.25922247248471752788377136433031;
        A(25,20) = 34.57343569803310676224343447365547;
        A(25,21) = 3.21147679440968961435417361847074;
        A(25,22) = -0.46040804173841439130720140423706;
        A(25,23) = -0.08707183398418105224318841379580;
        A(25,24) = -7.39351814158303067567016952195521;
    
        A(26,1) = 3.43347475853550878921093496257597;
        A(26,2) = 0;
        A(26,3) = 0;
        A(26,4) = 0;
        A(26,5) = 0;
        A(26,6) = 0;
        A(26,7) = 0;
        A(26,8) = 0;
        A(26,9) = 0.00249163204855817407538949148806;
        A(26,10) = 0.02301387878545931496383998463737;
        A(26,11) = -0.00322155956692977098724476092467;
        A(26,12) = 0.00988442549447664668946335414488;
        A(26,13) = 2.16252799377922507788307841904757;
        A(26,14) = -16.26998645464574213280656406601395;
        A(26,15) = -0.12853450212052455284358341747094;
        A(26,16) = -8.98915042666504253089307820833379;
        A(26,17) = -0.00348595363232025333387080201851;
        A(26,18) = 15.79361941133398075362351873886956;
        A(26,19) = -0.57440333091409506562816548201734;
        A(26,20) = -0.34560203902139329669272249660812;
        A(26,21) = -0.00662241490206585091731619991384;
        A(26,22) = -0.00777788129242204164032546458607;
        A(26,23) = -0.00356084192402274913338827232697;
        A(26,24) = 4.79282506449930799649797749629840;
        A(26,25) = 0.15372546487306857784457638740251;
    
        A(27,1) = 32.30385208719854423269947344400315;
        A(27,2) = 0;
        A(27,3) = 0;
        A(27,4) = 0;
        A(27,5) = 0;
        A(27,6) = -0.00317987696266205093901912847693;
        A(27,7) = 0.80639771490619207726082171152038;
        A(27,8) = 0.09759831264123889790935228506843;
        A(27,9) = 0.77857557815839890902751244645293;
        A(27,10) = 0.20489042383159942818949920209811;
        A(27,11) = -1.56261579627468188307070943950528;
        A(27,12) = 0;
        A(27,13) = 16.34298918823105706485042439739272;
        A(27,14) = -154.54455529354362123073018963147104;
        A(27,15) = 1.56971088703334872692034283417622;
        A(27,16) = 3.27685545087248131321429817269901;
        A(27,17) = -0.05034892451936531763480407271998;
        A(27,18) = 153.32115185804166507059376788591469;
        A(27,19) = 7.17568186327720495846766484814784;
        A(27,20) = -2.94036748675300481945917659896931;
        A(27,21) = -0.06658459460768031444707496760226;
        A(27,22) = -0.04623460549908436612292486685622;
        A(27,23) = -0.02041987335856794015393882286173;
        A(27,24) = -53.35231064387358505159534411660000;
        A(27,25) = -1.35548714715078654978732186705996;
        A(27,26) = -1.57196275801232751882901735171459;
    
        A(28,1) = -16.64514674863415128720312944039318;
        A(28,2) = 0;
        A(28,3) = 0;
        A(28,4) = 0;
        A(28,5) = 0;
        A(28,6) = 0.00592232780324503308042990005798;
        A(28,7) = 0.47032615996384111221722430320589;
        A(28,8) = 0.29968886384867900085398183709619;
        A(28,9) = -0.24765687759399491468999227632981;
        A(28,10) = 0.11089502977143768289399985183906;
        A(28,11) = 0;
        A(28,12) = -0.49171904384622914707066662870419;
        A(28,13) = -11.47431544272894969683894925643525;
        A(28,14) = 80.25931665762302725417024858864844;
        A(28,15) = -0.38413230398004284762531252675903;
        A(28,16) = 7.28147667468107583471326950926136;
        A(28,17) = -0.13269938461224837951057170817604;
        A(28,18) = -81.07998325257307266746792897522552;
        A(28,19) = -1.25037492835620639521768185656179;
        A(28,20) = 2.59263594969543681023776379504377;
        A(28,21) = -0.30144029834640453983016399726053;
        A(28,22) = 0.22138446078983233745170645157277;
        A(28,23) = 0.08275772747718929319559898709747;
        A(28,24) = 18.99606620406115204646724500372433;
        A(28,25) = 0.26923194640963968562346801512833;
        A(28,26) = 1.62674827447066537462989364929629;
        A(28,27) = 0.49171904384622914707066662870419;
    
        A(29,1) = 0.08384798124090526646169687913728;
        A(29,2) = 0;
        A(29,3) = 0;
        A(29,4) = 0;
        A(29,5) = 0;
        A(29,6) = -0.01179493671009738143197550560313;
        A(29,7) = -0.24729902056881265233947383874319;
        A(29,8) = 0.09780808583677290122593130140813;
        A(29,9) = 0.21759068924342063136000865176786;
        A(29,10) = 0;
        A(29,11) = 0.13758560676332522486565963219679;
        A(29,12) = 0.04398702297150466850587900923415;
        A(29,13) = 0;
        A(29,14) = -0.51370081376819334195700445661863;
        A(29,15) = 0.82635569115131550864421130839915;
        A(29,16) = 25.70181397198118326258738829725199;
        A(29,17) = 0;
        A(29,18) = 0;
        A(29,19) = 0;
        A(29,20) = 0;
        A(29,21) = 0;
        A(29,22) = 0;
        A(29,23) = 0;
        A(29,24) = -25.70181397198118326258738829725199;
        A(29,25) = -0.82635569115131550864421130839915;
        A(29,26) = 0.51370081376819334195700445661863;
        A(29,27) = -0.04398702297150466850587900923415;
        A(29,28) = -0.13758560676332522486565963219679;
    
        A(30,1) = 0.12438052665409441288151642086880;
        A(30,2) = 0;
        A(30,3) = 0;
        A(30,4) = 0;
        A(30,5) = 0.22612028219758430142223866297920;
        A(30,6) = 0.01378858876180808806076958370165;
        A(30,7) = -0.06722101339966844497493995074143;
        A(30,8) = 0;
        A(30,9) = 0;
        A(30,10) = -0.85623897508542835475534976987950;
        A(30,11) = -1.96337522866858908928262850028094;
        A(30,12) = -0.23233282272411940123724625730892;
        A(30,13) = 0;
        A(30,14) = 4.30660719086453349461668936876563;
        A(30,15) = -2.92722963249465482659787911202390;
        A(30,16) = -82.31316663978589444544923341054587;
        A(30,17) = 0;
        A(30,18) = 0;
        A(30,19) = 0;
        A(30,20) = 0;
        A(30,21) = 0;
        A(30,22) = 0;
        A(30,23) = 0;
        A(30,24) = 82.31316663978589444544923341054587;
        A(30,25) = 2.92722963249465482659787911202390;
        A(30,26) = -4.30660719086453349461668936876563;
        A(30,27) = 0.23233282272411940123724625730892;
        A(30,28) = 1.96337522866858908928262850028094;
        A(30,29) = 0.85623897508542835475534976987950;
    
        A(31,1) = 0.10348456163667977667299354651191;
        A(31,2) = 0;
        A(31,3) = 0;
        A(31,4) = 0.12206888730640722258964408286896;
        A(31,5) = 0.48257449033124662247513478012569;
        A(31,6) = -0.03814096000156069997308862400056;
        A(31,7) = 0;
        A(31,8) = -0.55049952531080232413838850702051;
        A(31,9) = 0;
        A(31,10) = -0.71191581158518922788764826204379;
        A(31,11) = -0.58412960567155134043298873015848;
        A(31,12) = 0;
        A(31,13) = 0;
        A(31,14) = 2.11046308125864932128717300046623;
        A(31,15) = -0.08374947367395721355257420230010;
        A(31,16) = 5.10021499072320914075295969043344;
        A(31,17) = 0;
        A(31,18) = 0;
        A(31,19) = 0;
        A(31,20) = 0;
        A(31,21) = 0;
        A(31,22) = 0;
        A(31,23) = 0;
        A(31,24) = -5.10021499072320914075295969043344;
        A(31,25) = 0.08374947367395721355257420230010;
        A(31,26) = -2.11046308125864932128717300046623;
        A(31,27) = 0;
        A(31,28) = 0.58412960567155134043298873015848;
        A(31,29) = 0.71191581158518922788764826204379;
        A(31,30) = 0.55049952531080232413838850702051;
    
        A(32,1) = 29/150;
        A(32,2) = 0;
        A(32,3) = 11/50;
        A(32,4) = -2/25;
        A(32,5) = 0;
        A(32,6) = 0;
        A(32,7) = 0.10999342558072470391946240486507;
        A(32,8) = -0.25429704807627016138406850699715;
        A(32,9) = 0;
        A(32,10) = 0.86557077711669425434377034382110;
        A(32,11) = 3.32416449114093083106799552786572;
        A(32,12) = 0;
        A(32,13) = 0;
        A(32,14) = -12.01022233159779338823523851486618;
        A(32,15) = 0.47660146624249323943044277686206;
        A(32,16) = -29.02430112210363905258026232136541;
        A(32,17) = 0;
        A(32,18) = 0;
        A(32,19) = 0;
        A(32,20) = 0;
        A(32,21) = 0;
        A(32,22) = 0;
        A(32,23) = 0;
        A(32,24) = 29.02430112210363905258026232136541;
        A(32,25) = -0.47660146624249323943044277686206;
        A(32,26) = 12.01022233159779338823523851486618;
        A(32,27) = 0;
        A(32,28) = -3.32416449114093083106799552786572;
        A(32,29) = -0.86557077711669425434377034382110;
        A(32,30) = 0.25429704807627016138406850699715;
        A(32,31) = -0.10999342558072470391946240486507;
    
        A(33,1) = -5/6;
        A(33,2) = 25/18;
        A(33,3) = 0;
        A(33,4) = 0;
        A(33,5) = -3/4;
        A(33,6) = 0;
        A(33,7) = -0.49252954371802630442268204911402;
        A(33,8) = 0;
        A(33,9) = 0;
        A(33,10) = 0;
        A(33,11) = 0;
        A(33,12) = 0;
        A(33,13) = 0;
        A(33,14) = 0;
        A(33,15) = 0;
        A(33,16) = 0;
        A(33,17) = 0;
        A(33,18) = 0;
        A(33,19) = 0;
        A(33,20) = 0;
        A(33,21) = 0;
        A(33,22) = 0;
        A(33,23) = 0;
        A(33,24) = 0;
        A(33,25) = 0;
        A(33,26) = 0;
        A(33,27) = 0;
        A(33,28) = 0;
        A(33,29) = 0;
        A(33,30) = 0;
        A(33,31) = 0.49252954371802630442268204911402;
        A(33,32) = 3/4;
    
        A(34,1) = 1/9;
        A(34,2) = 0;
        A(34,3) = -2/9;
        A(34,4) = 0;
        A(34,5) = 0;
        A(34,6) = 0;
        A(34,7) = 0;
        A(34,8) = 0;
        A(34,9) = 0;
        A(34,10) = 0;
        A(34,11) = 0;
        A(34,12) = 0;
        A(34,13) = 0;
        A(34,14) = 0;
        A(34,15) = 0;
        A(34,16) = 0;
        A(34,17) = 0;
        A(34,18) = 0;
        A(34,19) = 0;
        A(34,20) = 0;
        A(34,21) = 0;
        A(34,22) = 0;
        A(34,23) = 0;
        A(34,24) = 0;
        A(34,25) = 0;
        A(34,26) = 0;
        A(34,27) = 0;
        A(34,28) = 0;
        A(34,29) = 0;
        A(34,30) = 0;
        A(34,31) = 0;
        A(34,32) = 0;
        A(34,33) = 2/9;
    
        A(35,1) = 0.28583514038897155879608884216384;
        A(35,2) = 7/24;
        A(35,3) = 7/32;
        A(35,4) = 0;
        A(35,5) = 21/128;
        A(35,6) = 0;
        A(35,7) = 0.21819435494555665832718824158135;
        A(35,8) = 0.18039289847869776686363522194678;
        A(35,9) = 0;
        A(35,10) = 0.20571383940484501885912075512293;
        A(35,11) = 0.24271579158177023997028292795945;
        A(35,12) = 0.24646578081362930583360929118189;
        A(35,13) = -3.44991940790890824979834154601623;
        A(35,14) = 0.22887556216003608176072906073846;
        A(35,15) = 0.28329059970215141532152741905673;
        A(35,16) = 3.21085125837766640960131490544237;
        A(35,17) = -0.22353877736484569992023375621416;
        A(35,18) = -0.70712115720441907351872728620749;
        A(35,19) = 3.21123345150287080408174729202857;
        A(35,20) = 1.40954348309669766030414474301123;
        A(35,21) = -0.15136205344374261312160227674252;
        A(35,22) = 0.37235057452701427645472408021462;
        A(35,23) = 0.25297874640636133672219990776214;
        A(35,24) = -3.21085125837766640960131490544237;
        A(35,25) = -0.28329059970215141532152741905673;
        A(35,26) = -0.22887556216003608176072906073846;
        A(35,27) = -0.24646578081362930583360929118189;
        A(35,28) = -0.24271579158177023997028292795945;
        A(35,29) = -0.20571383940484501885912075512293;
        A(35,30) = -0.18039289847869776686363522194678;
        A(35,31) = -0.21819435494555665832718824158135;
        A(35,32) = -21/128;
        A(35,33) = -7/32;
        A(35,34) = -7/24;
    
        b(1) = 1/56;
        b(2) = 3/512;
        b(3) = 3/256;
        b(4) = 0;
        b(5) = 9/512;
        b(6) = 0;
        b(7) = 3/128;
        b(8) = 15/512;
        b(9) = 0;
        b(10) = 9/256;
        b(11) = 21/512;
        b(12) = 3/64;
        b(13) = 0;
        b(14) = 27/512;
        b(15) = 15/256;
        b(16) = 33/512;
        b(17) = 0;
        b(18) = 0.10535211357175301969149603288788;
        b(19) = 0.17056134624175218238212033855387;
        b(20) = 0.20622939732935194078352648570110;
        b(21) = 0.20622939732935194078352648570110;
        b(22) = 0.17056134624175218238212033855387;
        b(23) = 0.10535211357175301969149603288788;
        b(24) = -33/512;
        b(25) = -15/256;
        b(26) = -27/512;
        b(27) = -3/64;
        b(28) = -21/512;
        b(29) = -9/256;
        b(30) = -15/512;
        b(31) = -3/128;
        b(32) = -9/512;
        b(33) = -3/256;
        b(34) = -3/512;
        b(35) = 1/56;
end

c = c(:);
b = b(:);
z_0 = incond(:);
dzdt = odefun;

s_stages = numel(c);
m_augmented = numel(z_0);
m_base = round(sqrt(4*m_augmented + 1)/2 - 1/2);

t = (tspan(1) : tau : tspan(2)) .';
if t(end) ~= tspan(2)
    if (tau > 0 && t(end) < tspan(2)) || (tau < 0 && t(end) > tspan(2))
        t(end+1) = tspan(2);
    elseif abs(t(end) - tspan(2)) < tol
        t(end) = tspan(2);
    end
end

N = numel(t);
zsol = zeros(m_augmented, N);
K = zeros(m_augmented, s_stages);
dzdt_eval = zeros(N, m_augmented);
lyap_sum = zeros(m_base, 1);
lyap_exp = zeros(N, m_base);

zsol(:, 1) = z_0;

for n = 1:N - 1
        tau_n = t(n+1) - t(n);
        K(:, 1) = dzdt(t(n), zsol(:, n)); 
        
        dzdt_eval(n, :) = K(:, 1) .';
    
        for i = 2:s_stages
            K(:, i) = dzdt( ...
                t(n) + tau_n * c(i), ...
                zsol(:, n) + tau_n * K(:, 1:i-1) * A(i, 1:i-1).' ...
            );
        end
    
        zsol(:, n+1) = zsol(:, n) + tau_n * K * b;
        [Q, R] = qr(reshape(zsol(m_base + 1 : end, n+1), [m_base m_base]));
        zsol(m_base + 1 : end, n+1) = reshape(Q, [], 1);
        lyap_sum = lyap_sum + log(abs(diag(R)));
        lyap_exp(n + 1, :) = lyap_sum / (t(n + 1) - t(1));
end

dzdt_eval(end, :) = dzdt(t(end), zsol(:, end)) .';

zsol = zsol .';

end